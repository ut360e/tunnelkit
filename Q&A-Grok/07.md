# 07: Code Changes for Using Apple's Security Framework

**Question:** If I use Apple's Security framework, how much code do we need to change.

**Answer:** Switching to Apple's Security framework would require substantial changes, as the code heavily relies on OpenSSL's EVP (encryption), HMAC, and TLS functions. From inspection of `CryptoAEAD.m`, `TLSBox.m`, and `CryptoCBC.m`: 1) **Symmetric crypto** (EVP_Cipher*): Replace with CCCryptor or SecKey for AES operations—~200-300 lines per file. 2) **HMAC**: Replace EVP_MAC with CCHmac—~50-100 lines. 3) **TLS/SSL**: Replace SSL_CTX, BIO, X509 with SecureTransport or Network.framework's NWConnection—major rewrite of `TLSBox.m` (~400 lines). 4) **Cert handling**: Use SecCertificate instead of X509 functions—~100-200 lines. Total changes: 70-80% of these Obj-C files need rewriting (~1000-1500 lines). This is a large refactor; consider testing compatibility first or using a maintained OpenSSL fork instead.